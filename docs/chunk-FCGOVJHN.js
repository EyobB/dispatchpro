import{a as A}from"./chunk-2CBSTRET.js";import{a as I}from"./chunk-C72DZDNH.js";import{b as k,d as O,g as L,l as F,m as T,n as R,u as N}from"./chunk-VDT5TDP2.js";import"./chunk-25LA7BX7.js";import"./chunk-ZTGCRYCC.js";import"./chunk-XPCCV2FB.js";import"./chunk-KM6ROI6B.js";import"./chunk-2DXK6GBI.js";import{l as _,p as M,r as w}from"./chunk-TKJYB7RJ.js";import{Db as g,Eb as u,Fb as f,Ka as o,Nb as h,Ob as E,Pa as D,Pb as b,Ua as C,Za as y,fb as c,jb as e,kb as t,lb as x,rb as S,yb as r,zb as d}from"./chunk-ITTAAY47.js";function Z(p,n){if(p&1&&(e(0,"option",26),r(1),t()),p&2){let i=n.$implicit;c("value",i),o(),d(i)}}function j(p,n){if(p&1&&(e(0,"option",26),r(1),t()),p&2){let i=n.$implicit;c("value",i),o(),d(i)}}function U(p,n){if(p&1&&(e(0,"tr",27)(1,"td",28),r(2),t(),e(3,"td",28),r(4),t(),e(5,"td",28),r(6),t(),e(7,"td",28),r(8),h(9,"date"),t(),e(10,"td",28),r(11),t(),e(12,"td",28),r(13),t(),e(14,"td",28),r(15),t(),e(16,"td",28),r(17),h(18,"date"),t(),e(19,"td",28),r(20),t(),e(21,"td",28),r(22),t(),e(23,"td",28),r(24),t(),e(25,"td",28),r(26),h(27,"currency"),t()()),p&2){let i=n.$implicit;o(2),d(i.originCity),o(2),d(i.originState),o(2),d(i.originZipcode),o(2),d(b(9,12,i.pickupDateAndTime,"MM/dd/yy")),o(3),d(i.destinationCity),o(2),d(i.destinationState),o(2),d(i.destinationZipcode),o(2),d(b(18,15,i.dropOffDateAndTime,"MM/dd/yy")),o(3),d(i.loadNumber),o(2),d(i.driverName),o(2),d(i.truckNumber),o(2),d(E(27,18,i.totalAmount))}}var W=class p{constructor(n){this.orderService=n}orders=[];filters={startDate:this.toYMD(new Date(new Date().setMonth(new Date().getMonth()-1))),endDate:this.toYMD(new Date),driver:"",truck:"",status:""};ngOnInit(){this.applyFilters()}drivers=[];trucks=[];applyFilters(){this.orderService.getOrdersReport(this.filters.startDate,this.filters.endDate).subscribe(n=>{this.drivers=Array.from(new Set(n.map(i=>i.driverName))).sort(),this.trucks=Array.from(new Set(n.map(i=>i.truckNumber))).sort(),this.orders=n})}get filteredOrders(){return this.orders.filter(n=>{let i=!this.filters.driver||n.driverName===this.filters.driver,a=!this.filters.truck||n.truckNumber===this.filters.truck,m=!this.filters.status||n.status===this.filters.status;return i&&a&&m})}toYMD(n){let i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),m=String(n.getDate()).padStart(2,"0");return`${i}-${a}-${m}`}exportToCsv(){let n=["Origin City","Origin State","Origin Zip","Pickup Date","Destination City","Destination State","Destination Zip","Delivery Date","Load#","Driver","Truck","Value"],i=[];i.push(n.map(s=>this.toCsvValue(s)).join(",")),this.filteredOrders.forEach(s=>{let B=[s.originCity??"",s.originState??"",s.originZipcode??"",this.formatDateForCsv(s.pickupDateAndTime),s.destinationCity??"",s.destinationState??"",s.destinationZipcode??"",this.formatDateForCsv(s.dropOffDateAndTime),s.loadNumber??"",s.driverName??"",s.truckNumber??"",s.totalAmount??""];i.push(B.map(V=>this.toCsvValue(V)).join(","))});let a="\uFEFF"+i.join(`\r
`),m=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(m),v=document.createElement("a"),P=`orders_${this.filters.startDate||"all"}_to_${this.filters.endDate||"all"}.csv`;v.href=l,v.download=P,v.click(),URL.revokeObjectURL(l)}formatDateForCsv(n){if(!n)return"";let i=new Date(n);return isNaN(i.getTime())?"":i.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})}toCsvValue(n){let a=String(n??"").replace(/"/g,'""');return/[",\r\n]/.test(a)?`"${a}"`:a}static \u0275fac=function(i){return new(i||p)(D(I))};static \u0275cmp=C({type:p,selectors:[["app-list-report"]],decls:72,vars:7,consts:[[1,"order-list-report","p-6","bg-gray-100","w-full"],[1,"text-2xl","font-bold","text-gray-800","mb-4"],[1,"mb-4","flex","gap-4","justify-end","w-full","items-center"],[1,"flex-auto"],[1,"bg-blue-500","text-white","px-4","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"filters","mb-6","flex","flex-wrap","gap-4"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-gray-600"],["type","date","id","startDate",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["for","endDate",1,"text-gray-600"],["type","date","id","endDate",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["for","driver",1,"text-gray-600"],["id","driver",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","truck",1,"text-gray-600"],["id","truck",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],[1,"bg-green-500","text-white","px-4","py-2","rounded","hover:bg-green-600",3,"click"],[1,"overflow-x-auto","max-w-screen-xl"],[1,"table-auto","border-collapse","border","border-gray-300","bg-white","shadow-md","rounded-lg","w-full"],[1,"bg-gray-200"],["colspan","4",1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],["colspan","3",1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],["colspan","2",1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],[1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],["class","hover:bg-gray-100",4,"ngFor","ngForOf"],[3,"value"],[1,"hover:bg-gray-100"],[1,"border","border-gray-300","px-4","py-2"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"h2",1),r(2,"Order List Report"),t(),e(3,"div",2),x(4,"app-order-menu")(5,"span",3),e(6,"button",4),S("click",function(){return a.exportToCsv()}),r(7," Export to CSV "),t()(),e(8,"div",5)(9,"div",6)(10,"label",7),r(11,"Start Date:"),t(),e(12,"input",8),f("ngModelChange",function(l){return u(a.filters.startDate,l)||(a.filters.startDate=l),l}),t()(),e(13,"div",6)(14,"label",9),r(15,"End Date:"),t(),e(16,"input",10),f("ngModelChange",function(l){return u(a.filters.endDate,l)||(a.filters.endDate=l),l}),t()(),e(17,"div",6)(18,"label",11),r(19,"Driver:"),t(),e(20,"select",12),f("ngModelChange",function(l){return u(a.filters.driver,l)||(a.filters.driver=l),l}),e(21,"option",13),r(22,"All"),t(),y(23,Z,2,2,"option",14),t()(),e(24,"div",6)(25,"label",15),r(26,"Truck:"),t(),e(27,"select",16),f("ngModelChange",function(l){return u(a.filters.truck,l)||(a.filters.truck=l),l}),e(28,"option",13),r(29,"All"),t(),y(30,j,2,2,"option",14),t()(),e(31,"button",17),S("click",function(){return a.applyFilters()}),r(32," Apply Filters "),t()(),e(33,"div",18)(34,"table",19)(35,"thead",20)(36,"tr")(37,"th",21),r(38,"Origin"),t(),e(39,"th",21),r(40,"Destination"),t(),e(41,"th",22),r(42,"Logistics"),t(),x(43,"th",23),t()(),e(44,"thead",20)(45,"tr")(46,"th",24),r(47,"City"),t(),e(48,"th",24),r(49,"State"),t(),e(50,"th",24),r(51,"Zip"),t(),e(52,"th",24),r(53,"Pickup Date"),t(),e(54,"th",24),r(55,"City"),t(),e(56,"th",24),r(57,"State"),t(),e(58,"th",24),r(59,"Zip"),t(),e(60,"th",24),r(61,"Delivery Date"),t(),e(62,"th",24),r(63,"Load#"),t(),e(64,"th",24),r(65,"Driver"),t(),e(66,"th",24),r(67,"Truck"),t(),e(68,"th",24),r(69,"Value"),t()()(),e(70,"tbody"),y(71,U,28,20,"tr",25),t()()()()),i&2&&(o(12),g("ngModel",a.filters.startDate),o(4),g("ngModel",a.filters.endDate),o(4),g("ngModel",a.filters.driver),o(3),c("ngForOf",a.drivers),o(4),g("ngModel",a.filters.truck),o(3),c("ngForOf",a.trucks),o(41),c("ngForOf",a.filteredOrders))},dependencies:[N,T,R,k,F,O,L,M,w,_,A],encapsulation:2})};export{W as ListReportComponent};
