import{a as F,b as N}from"./chunk-YK2LZHPZ.js";import{b as O}from"./chunk-DDEBU2FK.js";import{a as j}from"./chunk-DQ3FC3IJ.js";import{a as P}from"./chunk-EQUZ66DX.js";import{a as _}from"./chunk-NOERRO3T.js";import{a as B}from"./chunk-74GXZ5HC.js";import"./chunk-BCYCRGTW.js";import"./chunk-Z2SYLYEN.js";import"./chunk-XPCCV2FB.js";import{c as T}from"./chunk-3IYQXLZN.js";import"./chunk-Z3DWEABJ.js";import{l as C,m as w,p as k,q as A}from"./chunk-RIFGPENF.js";import{Ab as m,Bb as d,Ga as S,La as a,Ob as p,Pb as I,Qa as c,Qb as v,Va as D,Ya as y,_a as g,gb as f,kb as i,lb as e,mb as b,sb as h,x as E,zb as t}from"./chunk-OP2CD5JB.js";var x=class l{transform(r){if(!r)return"-";let{street:o,city:n,state:s,zip:u}=r;return[o,n,s,u].filter(Boolean).join(", ")}static \u0275fac=function(o){return new(o||l)};static \u0275pipe=y({name:"address",type:l,pure:!0})};function R(l,r){l&1&&(i(0,"div",28)(1,"div",29),b(2,"div",30),i(3,"p",31),t(4,"Loading drivers..."),e()()())}function z(l,r){if(l&1&&(i(0,"tr",32)(1,"td",33),t(2),e(),i(3,"td",34),t(4),p(5,"number"),e()()),l&2){let o=r.$implicit;a(2),m(o.description),a(2),d("$",v(5,2,o.amount,"1.2-2"),"")}}var L=class l{constructor(r,o,n,s,u){this.carrierService=r;this.invoiceService=o;this.orderService=n;this.route=s;this.toastService=u}loading=!1;carrier=null;invoice=new F;order=new O;ngOnInit(){let r=this.route.snapshot.paramMap.get("id"),o=this.route.snapshot.paramMap.get("orderId");if(!r||!o)throw new Error("Invoice ID and Order ID are required");this.loading=!0,E({carrier:this.carrierService.getCarrier(),order:this.orderService.getOrder(o),invoice:this.invoiceService.getCarrierInvoice(r)}).subscribe(({carrier:n,order:s,invoice:u})=>{this.carrier=n,this.order=s,this.invoice=u,this.invoice.origin=this.getOriginAddress(s),this.invoice.destination=this.getDestinationAddress(s),this.invoice.lineItems=this.invoice.lineItems||[],this.invoice.lineItems.push(new N("Rate",s.rate)),this.invoice.lineItems.push(...s.driverCosts),this.loading=!1},n=>{this.loading=!1,console.error("Error loading invoice details:",n),this.toastService.showError("Failed to load invoice details.")})}getOriginAddress(r){return{street:r.originStreetAddress,city:r.originCity,state:r.originState,zip:r.originZipcode}}getDestinationAddress(r){return{street:r.destinationStreetAddress,city:r.destinationCity,state:r.destinationState,zip:r.destinationZipcode}}get subtotal(){return this.invoice.lineItems?.reduce((r,o)=>r+o.amount,0)}get grandTotal(){return this.subtotal}paymentInstructions=`Please remit payment to:<br>
    Philosia LLC<br>
    Bank: First National Bank<br>
    Account #: 123456789<br>
    Routing #: 987654321<br>
    Reference: INV-2025-001`;notes="Thank you for your business! Please contact us if you have any questions regarding this invoice.";printInvoice(){let r=document.getElementById("invoice-print")?.innerHTML;if(r){let o=window.open("","","height=700,width=900");o&&(o.document.write(`
          <html>
            <head>
              <title>Print Invoice</title>
              <link rel="stylesheet" href="styles.css">
              <style>
                body { font-family: Arial, sans-serif; margin: 2rem; }
                .print\\:hidden { display: none !important; }
                /* Add more styles as needed for print */
              </style>
            </head>
            <body>${r}</body>
          </html>
        `),o.document.close(),o.focus(),setTimeout(()=>{o.print(),o.close()},300))}}sendToBroker(){alert("Invoice sent to broker!")}static \u0275fac=function(o){return new(o||l)(c(P),c(j),c(_),c(T),c(B))};static \u0275cmp=D({type:l,selectors:[["app-invoice-detail"]],decls:127,vars:35,consts:[["class","grid place-items-center bg-white/70 backdrop-blur-sm",4,"ngIf"],["id","invoice-print",1,"max-w-2xl","mx-auto","p-6","bg-white","rounded-2xl","shadow-2xl","border","border-green-100"],[1,"mb-4","border-b","border-green-200","pb-3"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","items-start","sm:items-center"],[1,"text-2xl","font-extrabold","text-green-900","mb-1","tracking-tight","flex","items-center","gap-2"],[1,"font-semibold","text-base"],[1,"text-gray-700","text-sm"],[1,"mt-1","text-xs","text-gray-600","flex","flex-wrap","gap-4"],[1,"font-semibold"],[1,"mt-4","sm:mt-0","text-right","space-y-1","text-sm"],[1,"font-semibold","text-lg","text-green-900","mb-1","flex","items-center","gap-2"],[1,"flex","flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"flex","flex-col","justify-between","sm:flex-row","gap-6"],[1,"flex-2"],[1,"mb-1"],[1,"flex-3"],[1,"min-w-full","mb-2","border","border-green-300","rounded-lg","shadow-sm","overflow-hidden","text-sm"],[1,"bg-green-100"],[1,"text-left","py-2","px-4","border-b","border-green-200","font-semibold"],[1,"text-right","py-2","px-4","border-b","border-green-200","font-semibold"],["class","hover:bg-green-50 transition",4,"ngFor","ngForOf"],[1,"flex","flex-col","items-end","space-y-0.5","mt-1","text-sm"],[1,"text-lg","font-extrabold","text-green-800","mt-1"],[1,"font-semibold","text-lg","text-green-900","mb-1","mt-3","flex","items-center","gap-2"],[1,"text-gray-700","text-sm",3,"innerHTML"],[1,"flex","justify-between","gap-2","mb-2","print:hidden"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded","shadow","font-semibold","transition",3,"click"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded","shadow","font-semibold","transition",3,"click"],[1,"grid","place-items-center","bg-white/70","backdrop-blur-sm"],[1,"flex","flex-col","items-center"],[1,"h-10","w-10","border-4","border-green-600","border-t-transparent","rounded-full","animate-spin"],[1,"mt-3","text-sm","text-gray-700","font-medium"],[1,"hover:bg-green-50","transition"],[1,"py-2","px-4","border-b","border-green-100"],[1,"py-2","px-4","border-b","border-green-100","text-right"]],template:function(o,n){o&1&&(g(0,R,5,0,"div",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h2",4)(6,"span"),t(7,"\u{1F9FE}"),e(),t(8," Carrier Invoice "),e(),i(9,"div",5),t(10),e(),i(11,"div",6),t(12),e(),i(13,"div",7)(14,"span")(15,"span",8),t(16,"Phone:"),e(),t(17),e(),i(18,"span")(19,"span",8),t(20,"Email:"),e(),t(21),e()()(),i(22,"div",9)(23,"div")(24,"span",8),t(25,"Invoice #:"),e(),t(26),e(),i(27,"div")(28,"span",8),t(29,"Invoice Date:"),e(),t(30),e()()()(),i(31,"div",2)(32,"h3",10)(33,"span"),t(34,"\u{1F3E2}"),e(),t(35," Billed To "),e(),i(36,"div",11)(37,"div")(38,"div",5),t(39),e(),i(40,"div",6),t(41),e(),i(42,"div",7)(43,"span")(44,"span",8),t(45,"Phone:"),e(),t(46),e(),i(47,"span")(48,"span",8),t(49,"Email:"),e(),t(50),e()()(),i(51,"div",9)(52,"div")(53,"span",8),t(54,"Load #:"),e(),t(55),e(),i(56,"div")(57,"span",8),t(58,"PoD #:"),e(),t(59),e()()()(),i(60,"div",2)(61,"h3",10)(62,"span"),t(63,"\u{1F69A}"),e(),t(64," Description of Services "),e(),i(65,"div")(66,"div",12)(67,"div",13)(68,"div",8),t(69,"Pickup Date:"),e(),i(70,"div",14),t(71),p(72,"date"),e(),i(73,"div",8),t(74,"Delivery Date:"),e(),i(75,"div",14),t(76),p(77,"date"),e()(),i(78,"div",15)(79,"div",8),t(80,"Origin:"),e(),i(81,"div",14),t(82),p(83,"address"),e(),i(84,"div",8),t(85,"Destination:"),e(),i(86,"div",14),t(87),p(88,"address"),e()()()()(),i(89,"div",2)(90,"h3",10)(91,"span"),t(92,"\u{1F4B2}"),e(),t(93," Rates and Charges "),e(),i(94,"table",16)(95,"thead")(96,"tr",17)(97,"th",18),t(98,"Description"),e(),i(99,"th",19),t(100,"Amount"),e()()(),i(101,"tbody"),g(102,z,6,5,"tr",20),e()(),i(103,"div",21)(104,"div",22),t(105),p(106,"number"),e()()(),i(107,"div",2)(108,"h3",23)(109,"span"),t(110,"\u{1F3E6}"),e(),t(111," Payment Instructions "),e(),b(112,"div",24),e(),i(113,"div")(114,"h3",10)(115,"span"),t(116,"\u{1F4DD}"),e(),t(117," Notes "),e(),i(118,"div",6),t(119),e()()(),i(120,"div",25)(121,"button",26),h("click",function(){return n.printInvoice()}),t(122," \u{1F5A8}\uFE0F Print Invoice "),e(),i(123,"div"),t(124),e(),i(125,"button",27),h("click",function(){return n.sendToBroker()}),t(126," \u{1F4E4} Send to Broker "),e()()),o&2&&(f("ngIf",n.loading),a(10),m(n.carrier==null?null:n.carrier.name),a(2),m(n.carrier==null?null:n.carrier.address),a(5),d(" ",n.carrier==null?null:n.carrier.contactPhone,""),a(4),d(" ",n.carrier==null?null:n.carrier.contactEmail,""),a(5),d(" ",n.invoice.invoiceNumber,""),a(4),d(" ",n.invoice.invoiceDate,""),a(9),m(n.order.brokerName),a(2),m(n.order.brokerName),a(5),d(" ",n.order.brokerContact,""),a(4),d(" ",n.order.brokerEmail,""),a(5),d(" ",n.invoice.loadNumber,""),a(4),d(" ",n.invoice.podNumber,""),a(12),m(v(72,22,n.order.pickupDateAndTime,"short")),a(5),m(v(77,25,n.order.dropOffDateAndTime,"short")),a(6),m(I(83,28,n.invoice.origin)),a(5),m(I(88,30,n.invoice.destination)),a(15),f("ngForOf",n.invoice.lineItems),a(3),d(" Total: $",v(106,32,n.grandTotal,"1.2-2")," "),a(7),f("innerHTML",n.paymentInstructions,S),a(7),d(" ",n.notes," "),a(5),d("Broker email: ",n.invoice.brokerEmail,""))},dependencies:[w,C,k,A,x],encapsulation:2})};export{L as CarrierInvoiceDetailComponent};
