import{b as S,d as v,e as x,f as w,g as y,h as q,q as R,u as M}from"./chunk-SVMRWARE.js";import{a as b}from"./chunk-U7GEWMPU.js";import"./chunk-N2E3WRFD.js";import"./chunk-IRZ6KZAB.js";import{e as h}from"./chunk-KA6K7UZ3.js";import"./chunk-GDLZFIOX.js";import"./chunk-GEVPNXBN.js";import{Bb as m,Cb as d,Db as u,Ja as a,Oa as g,Ta as p,ib as t,jb as i,qb as f,wb as r}from"./chunk-YSP72ENP.js";var C=class c{constructor(s,e){this.router=s;this.sessionService=e}loginRequest={email:"",password:""};login(){console.log("Login request:",this.loginRequest),this.loginRequest.email&&this.loginRequest.password&&this.sessionService.login(this.loginRequest.email,this.loginRequest.password).subscribe(s=>{if(!s)console.error("Login failed");else{let e=this.sessionService.getLoggedInUser();if(!e){console.error("Failed to retrieve logged in user");return}let n=e.roles.includes("Driver"),l=e.roles.includes("Dispatcher"),o=e.roles.includes("Admin"),L=e.roles.includes("SuperAdmin");if(this.sessionService.isMobileScreen()&&n)this.router.navigate(["/driver/current-orders"]);else if((l||o)&&!this.sessionService.isMobileScreen())this.router.navigate(["/dispatcher/orders"]);else if(L&&!this.sessionService.isMobileScreen())this.router.navigate(["/dispatcher/users"]);else{this.sessionService.logout();let _="This device is not suitable for your role: "+e.roles.concat(", ");this.router.navigate(["/error",_])}}},s=>{console.error("Login error:",s)})}resetForm(){this.loginRequest.email="",this.loginRequest.password=""}static \u0275fac=function(e){return new(e||c)(g(h),g(b))};static \u0275cmp=p({type:c,selectors:[["app-login"]],decls:25,vars:2,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-green-100","to-green-300","px-2"],[1,"bg-white","rounded-2xl","shadow-2xl","p-6","sm:p-8","w-full","max-w-md"],[1,"flex","flex-col","items-center","mb-6"],[1,"text-5xl","mb-2"],[1,"text-3xl","font-bold","text-green-900","mb-2","text-center"],[1,"text-green-700","text-center"],[1,"space-y-4",3,"ngSubmit"],[1,"mb-4"],["for","email",1,"block","text-green-900","font-semibold","mb-1"],["id","email","type","email","name","email","required","",1,"w-full","border","border-green-200","rounded","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-400",3,"ngModelChange","ngModel"],["for","password",1,"block","text-green-900","font-semibold","mb-1"],["id","password","type","password","name","password","required","",1,"w-full","border","border-green-200","rounded","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-400",3,"ngModelChange","ngModel"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4","gap-2"],["href","#",1,"text-green-700","hover:underline","text-sm","text-right"],["type","submit",1,"w-full","bg-green-600","hover:bg-green-700","text-white","font-bold","py-2","rounded","transition"],[1,"mt-6","text-center","text-green-800","text-sm"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),r(4,"\u{1F69A}"),i(),t(5,"h2",4),r(6,"DispatchPro Login"),i(),t(7,"p",5),r(8,"Sign in to your account"),i()(),t(9,"form",6),f("ngSubmit",function(){return n.login()}),t(10,"div",7)(11,"label",8),r(12,"Email"),i(),t(13,"input",9),u("ngModelChange",function(o){return d(n.loginRequest.email,o)||(n.loginRequest.email=o),o}),i()(),t(14,"div",7)(15,"label",10),r(16,"Password"),i(),t(17,"input",11),u("ngModelChange",function(o){return d(n.loginRequest.password,o)||(n.loginRequest.password=o),o}),i()(),t(18,"div",12)(19,"a",13),r(20,"Forgot password?"),i()(),t(21,"button",14),r(22," Sign In "),i()(),t(23,"div",15),r(24," \xA9 2025 DispatcherPro. All rights reserved. "),i()()()),e&2&&(a(13),m("ngModel",n.loginRequest.email),a(4),m("ngModel",n.loginRequest.password))},dependencies:[M,q,S,v,x,R,y,w],encapsulation:2})};export{C as LoginComponent};
