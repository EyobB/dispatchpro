import{a as I}from"./chunk-74GXZ5HC.js";import{a as C}from"./chunk-Z2SYLYEN.js";import"./chunk-XPCCV2FB.js";import{e as y}from"./chunk-3IYQXLZN.js";import"./chunk-Z3DWEABJ.js";import{l as S,m as E}from"./chunk-RIFGPENF.js";import{$ as f,Ab as u,Bb as _,Cb as w,La as l,Qa as m,Va as h,_ as x,_a as c,gb as d,kb as i,lb as t,mb as b,pb as D,sb as v,tb as p,zb as r}from"./chunk-OP2CD5JB.js";function F(o,n){if(o&1&&(i(0,"span",18),r(1,"\u26A0\uFE0F"),t()),o&2){let e=p().$implicit;d("title",e.warnings.join(", "))}}function T(o,n){if(o&1){let e=D();i(0,"tr",11)(1,"td",12),r(2),t(),i(3,"td",13),r(4),t(),i(5,"td",13),r(6),t(),i(7,"td",13),r(8),t(),i(9,"td",13),r(10),t(),i(11,"td",13)(12,"div",14)(13,"button",15),v("click",function(){let s=x(e).$implicit,g=p();return f(g.viewDriver(s))}),r(14," View "),t(),i(15,"button",16),v("click",function(){let s=x(e).$implicit,g=p();return f(g.deleteDriver(s))}),r(16," Delete "),t(),c(17,F,2,1,"span",17),t()()()}if(o&2){let e=n.$implicit;l(2),u(e.name),l(2),u(e.phone),l(2),w("",e.licenseState," - ",e.licenseNumber,""),l(2),_(" ",e.documents.length||0," document(s)"),l(2),u((e.truck==null?null:e.truck.plate)||"\u2014"),l(7),d("ngIf",e.warnings.length>0)}}function N(o,n){o&1&&(i(0,"div",19)(1,"div",20),b(2,"div",21),i(3,"p",22),r(4,"Loading drivers..."),t()()())}var k=class o{constructor(n,e,a){this.driversService=n;this.router=e;this.toastService=a}drivers=[];loading=!1;ngOnInit(){this.loading=!0,this.driversService.getDrivers().subscribe(n=>{this.drivers=n,this.loading=!1},n=>{console.error("Error loading drivers",n),this.loading=!1,this.toastService.showError("Failed to load drivers. Please try again later.")})}addDriver(){this.router.navigate(["/dispatcher/drivers/new"])}viewDriver(n){this.router.navigate(["/dispatcher/drivers",n.id])}deleteDriver(n){confirm(`Are you sure you want to delete driver "${n.name}"? This action cannot be undone.`)&&this.driversService.deleteDriver(n).subscribe({next:()=>{this.drivers=this.drivers.filter(e=>e.id!==n.id)},error:e=>{console.error("Error deleting driver:",e),alert("Failed to delete driver. Please try again.")}})}isLicenseExpiringSoon(n){let e=new Date(n),a=new Date,s=new Date;return s.setMonth(a.getMonth()+1),e<s}static \u0275fac=function(e){return new(e||o)(m(C),m(y),m(I))};static \u0275cmp=h({type:o,selectors:[["app-drivers"]],decls:27,vars:2,consts:[[1,"p-6","pt-0"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-bold","text-green-900","flex","items-center","gap-2"],[1,"bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded","shadow","font-semibold","transition",3,"click"],[1,"overflow-x-auto","rounded-lg","shadow-lg","bg-white"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-green-900","text-white"],[1,"px-4","py-3","text-left","font-semibold"],[1,"bg-white","divide-y","divide-gray-100"],["class","hover:bg-green-50 transition",4,"ngFor","ngForOf"],["class","grid place-items-center bg-white/70 backdrop-blur-sm",4,"ngIf"],[1,"hover:bg-green-50","transition"],[1,"px-4","py-2","font-medium","text-green-900"],[1,"px-4","py-2"],[1,"flex","items-center","gap-2"],[1,"bg-blue-600","hover:bg-blue-700","transition","text-white","px-3","py-1","rounded","shadow",3,"click"],[1,"bg-red-600","hover:bg-red-700","transition","text-white","px-3","py-1","rounded","shadow",3,"click"],["class","text-yellow-500 align-middle",3,"title",4,"ngIf"],[1,"text-yellow-500","align-middle",3,"title"],[1,"grid","place-items-center","bg-white/70","backdrop-blur-sm"],[1,"flex","flex-col","items-center"],[1,"h-10","w-10","border-4","border-green-600","border-t-transparent","rounded-full","animate-spin"],[1,"mt-3","text-sm","text-gray-700","font-medium"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2)(3,"span"),r(4,"\u{1F9D1}\u200D\u2708\uFE0F"),t(),r(5," Drivers "),t(),i(6,"button",3),v("click",function(){return a.addDriver()}),r(7," + Add Driver "),t()(),i(8,"div",4)(9,"table",5)(10,"thead",6)(11,"tr")(12,"th",7),r(13,"Name"),t(),i(14,"th",7),r(15,"Phone"),t(),i(16,"th",7),r(17,"License #"),t(),i(18,"th",7),r(19,"Documents"),t(),i(20,"th",7),r(21,"Assigned Truck"),t(),i(22,"th",7),r(23,"Actions"),t()()(),i(24,"tbody",8),c(25,T,18,7,"tr",9),t()()(),c(26,N,5,0,"div",10),t()),e&2&&(l(25),d("ngForOf",a.drivers),l(),d("ngIf",a.loading))},dependencies:[S,E],encapsulation:2})};export{k as DriversComponent};
