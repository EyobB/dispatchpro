import{a as j}from"./chunk-3QMJAE3L.js";import{a as b}from"./chunk-7GTRUKFK.js";import{a as v,b as N}from"./chunk-XUC5GDXE.js";import"./chunk-LIL63FBP.js";import{a as T}from"./chunk-OXCJF6DH.js";import"./chunk-NBSK5KUW.js";import"./chunk-IMHYAPIP.js";import"./chunk-XPCCV2FB.js";import{e as F}from"./chunk-3TOGTSGL.js";import"./chunk-FSJQQIFH.js";import{l as I,m as k}from"./chunk-QAAQ2EEP.js";import{$ as c,Ab as _,Bb as w,La as m,Qa as x,Qb as D,Va as h,_ as s,_a as g,gb as E,ib as C,kb as t,lb as i,mb as S,nb as R,ob as V,pb as f,sb as u,tb as d,yb as y,zb as r}from"./chunk-QJGZKU5F.js";function L(a,n){if(a&1){let e=f();t(0,"li",9),u("click",function(){let l=s(e).$implicit,p=d();return c(p.selectEmail(l))}),t(1,"div",10),r(2),i(),t(3,"div",11),r(4),i(),t(5,"div",12),r(6),i()()}if(a&2){let e=n.$implicit,o=d();C("bg-green-100",o.selectedEmail===e),m(2),_(e.sender),m(2),_(e.subject),m(2),_(e.date)}}function M(a,n){if(a&1){let e=f();t(0,"li",24)(1,"a",25),u("click",function(){let l=s(e).$implicit,p=d(2);return c(p.viewDocument(l))}),r(2),i(),t(3,"button",26),u("click",function(){let l=s(e).$implicit,p=d(2);return c(p.viewDocument(l))}),r(4,"View"),i()()}if(a&2){let e=n.$implicit;m(2),w(" ",e.fileName,"")}}function P(a,n){if(a&1){let e=f();R(0),t(1,"h3",13),r(2),i(),t(3,"p",14),r(4),i(),t(5,"p",15),r(6),i(),t(7,"div",16)(8,"textarea",17),r(9),i()(),t(10,"div",18)(11,"h4",19),r(12,"Attachments"),i(),t(13,"ul"),g(14,M,5,1,"li",20),i()(),t(15,"div",21)(16,"button",22),u("click",function(){s(e);let l=d();return c(l.confirmRateCon())}),r(17,"Confirm as RateCon"),i(),t(18,"button",23),u("click",function(){s(e);let l=d();return c(l.dismissEmail())}),r(19,"Dismiss"),i()(),V()}if(a&2){let e=d();m(2),_(e.selectedEmail.subject),m(2),w("From: ",e.selectedEmail.sender,""),m(2),w("Received: ",e.selectedEmail.date,""),m(3),_(e.selectedEmail.body),m(5),E("ngForOf",e.selectedEmail.documents)}}function A(a,n){a&1&&(t(0,"p",27),r(1,"Select an email to review details."),i())}var O=class a{constructor(n,e,o){this.rateConEmailService=n;this.router=e;this.toastService=o}emails=[];selectedEmail=new v;currentDocument=new b;showDocumentViewer=!1;ngOnInit(){this.loadEmails()}loadEmails(){this.rateConEmailService.getRateConEmails().subscribe(n=>{this.emails=n,this.selectFirstEmail()})}selectEmail(n){this.selectedEmail=n}confirmRateCon(){this.router.navigate(["dispatcher/ratecon-from-email/",this.selectedEmail.id])}dismissEmail(){this.rateConEmailService.deleteEmail(this.selectedEmail.id).subscribe(()=>{this.removeEmailFromList(),this.toastService.showSuccess("Email dismissed successfully")})}removeEmailFromList(){this.emails=this.emails.filter(n=>n!==this.selectedEmail),this.selectedEmail=new v,this.selectFirstEmail()}selectFirstEmail(){this.emails.length>0?this.selectedEmail=this.emails[0]:this.selectedEmail=new v}viewDocument(n){this.currentDocument=n,this.showDocumentViewer=!0}closeDocumentViewer(){this.showDocumentViewer=!1,this.currentDocument=new b}onDownloadError(n){console.error("Download failed:",n),this.toastService.showError("Failed to download document")}static \u0275fac=function(e){return new(e||a)(x(N),x(F),x(T))};static \u0275cmp=h({type:a,selectors:[["app-ratecon-emails"]],decls:12,vars:5,consts:[["noSelection",""],[1,"flex","h-screen","bg-gray-50"],[1,"w-1/3","border-r","border-gray-300","p-4","overflow-y-auto"],[1,"text-xl","font-semibold","mb-4"],["type","text","placeholder","Search...",1,"w-full","mb-3","p-2","border","rounded"],["class","p-2 mb-2 rounded hover:bg-green-50 cursor-pointer",3,"bg-green-100","click",4,"ngFor","ngForOf"],[1,"w-2/3","p-4"],[4,"ngIf","ngIfElse"],[3,"close","downloadError","document","isVisible"],[1,"p-2","mb-2","rounded","hover:bg-green-50","cursor-pointer",3,"click"],[1,"font-medium"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-gray-400"],[1,"text-lg","font-semibold","mb-2"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-sm","text-gray-600","mb-4"],[1,"border","p-3","rounded","mb-4","bg-white"],["rows","10",1,"text-gray-700","w-full"],[1,"mb-4"],[1,"font-medium","mb-2"],["class","flex justify-between bg-gray-100 p-2 mb-1 rounded",4,"ngFor","ngForOf"],[1,"flex","gap-3"],[1,"bg-green-600","text-white","px-4","py-2","rounded","hover:bg-green-700",3,"click"],[1,"bg-red-500","text-white","px-4","py-2","rounded","hover:bg-red-600",3,"click"],[1,"flex","justify-between","bg-gray-100","p-2","mb-1","rounded"],["href","javascript:void(0)",1,"text-blue-500","underline","cursor-pointer",3,"click"],[1,"text-blue-600","hover:underline",3,"click"],[1,"text-gray-400"]],template:function(e,o){if(e&1){let l=f();t(0,"div",1)(1,"div",2)(2,"h2",3),r(3,"RateCon Emails"),i(),S(4,"input",4),t(5,"ul"),g(6,L,7,5,"li",5),i()(),t(7,"div",6),g(8,P,20,5,"ng-container",7)(9,A,2,0,"ng-template",null,0,D),i()(),t(11,"app-document-viewer",8),u("close",function(){return s(l),c(o.closeDocumentViewer())})("downloadError",function($){return s(l),c(o.onDownloadError($))}),i()}if(e&2){let l=y(10);m(6),E("ngForOf",o.emails),m(2),E("ngIf",o.selectedEmail.id)("ngIfElse",l),m(3),E("document",o.currentDocument)("isVisible",o.showDocumentViewer)}},dependencies:[k,I,j],encapsulation:2})};export{O as RateconEmailsComponent};
