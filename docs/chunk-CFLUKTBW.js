import{a as v}from"./chunk-FAZMLUFE.js";import{c as j}from"./chunk-CFVKQP3S.js";import{a as H}from"./chunk-NTYF7ZMB.js";import{d as P,g as N,l as R,m as F,n as B,u as L}from"./chunk-SVMRWARE.js";import{a as $}from"./chunk-DA7YCHM5.js";import"./chunk-3TXZS4HG.js";import"./chunk-5R44ZK2D.js";import"./chunk-XPCCV2FB.js";import{e as M}from"./chunk-KA6K7UZ3.js";import"./chunk-GDLZFIOX.js";import{l as V,m as k,p as A}from"./chunk-GEVPNXBN.js";import{Ab as C,Bb as h,Cb as w,Db as y,Ja as d,Kb as b,Mb as S,Nb as T,Oa as O,Ta as D,Y as p,Ya as g,Z as m,eb as _,ib as r,jb as i,nb as f,qb as x,rb as c,vb as I,wb as n,xb as u,yb as E}from"./chunk-YSP72ENP.js";function W(l,t){l&1&&(r(0,"div",8),n(1," No current orders. "),i())}function Z(l,t){if(l&1&&(r(0,"option",29),n(1),i()),l&2){let e=t.$implicit;_("value",e),d(),u(e)}}function Y(l,t){if(l&1){let e=f();r(0,"span",26)(1,"select",27),y("ngModelChange",function(o){p(e);let a=c().$implicit;return w(a.status,o)||(a.status=o),m(o)}),x("change",function(){p(e);let o=c().$implicit,a=c();return m(a.updateOrderStatus(o))}),g(2,Z,2,2,"option",28),i()()}if(l&2){let e=c().$implicit,s=c();d(),h("ngModel",e.status),d(),_("ngForOf",s.statuses)}}function U(l,t){if(l&1&&(r(0,"span",26),n(1),i()),l&2){let e=c().$implicit;d(),u(e.status)}}function K(l,t){if(l&1){let e=f();r(0,"button",24),x("click",function(){p(e);let o=c().$implicit,a=c();return m(a.completeOrder(o))}),n(1," Complete Order "),i()}}function q(l,t){if(l&1){let e=f();r(0,"div",9)(1,"div",10)(2,"div",11),n(3),i(),g(4,Y,3,2,"span",12)(5,U,2,1,"ng-template",null,0,T),i(),r(7,"div",13)(8,"div")(9,"div",14)(10,"span",15),n(11,"Pickup:"),i(),r(12,"span",16),n(13),b(14,"date"),i()(),r(15,"div",17)(16,"div",18)(17,"div"),n(18),i(),r(19,"div"),n(20),i()(),r(21,"button",19),x("click",function(){let o=p(e).$implicit,a=c();return m(a.copyOriginAddress(o))}),n(22," \u{1F4CB} "),i()()(),r(23,"div")(24,"div",14)(25,"span",15),n(26,"Dropoff:"),i(),r(27,"span",16),n(28),b(29,"date"),i()(),r(30,"div",17)(31,"div",18)(32,"div"),n(33),i(),r(34,"div"),n(35),i()(),r(36,"button",19),x("click",function(){let o=p(e).$implicit,a=c();return m(a.copyDestinationAddress(o))}),n(37," \u{1F4CB} "),i()()()(),r(38,"div",20)(39,"div")(40,"span",16),n(41,"Order #: "),i(),r(42,"span",21),n(43),i()()(),r(44,"div",22)(45,"button",23),x("click",function(){let o=p(e).$implicit,a=c();return m(a.checkIn(o))}),n(46," Check In "),i(),r(47,"button",23),x("click",function(){let o=p(e).$implicit,a=c();return m(a.viewOrder(o))}),n(48," View Details "),i(),r(49,"button",24),x("click",function(){let o=p(e).$implicit,a=c();return m(a.uploadPoD(o))}),n(50," Upload PoD "),i(),g(51,K,2,0,"button",25),i()()}if(l&2){let e=t.$implicit,s=I(6),o=c();d(3),u(e.loadNumber),d(),_("ngIf",!o.isPartiallyDelivered(e))("ngIfElse",s),d(9),u(S(14,15,e.pickupDateAndTime,"EEE, MMM dd HH:mm")),d(5),u(e.originStreetAddress),d(2),C("",e.originCity,", ",e.originState," ",e.originZipcode,""),d(8),u(S(29,18,e.dropOffDateAndTime,"EEE, MMM dd HH:mm")),d(5),u(e.destinationStreetAddress),d(2),C("",e.destinationCity,", ",e.destinationState," ",e.destinationZipcode,""),d(8),u(e.orderNumber),d(8),_("ngIf",o.isReadyToComplete(e))}}function z(l,t){l&1&&(r(0,"div",8),n(1," No upcoming orders. "),i())}function J(l,t){if(l&1&&(r(0,"option",29),n(1),i()),l&2){let e=t.$implicit;_("value",e),d(),u(e)}}function Q(l,t){if(l&1){let e=f();r(0,"div",30)(1,"div",10)(2,"div",11),n(3),i(),r(4,"span",26)(5,"select",27),y("ngModelChange",function(o){let a=p(e).$implicit;return w(a.status,o)||(a.status=o),m(o)}),x("change",function(){let o=p(e).$implicit,a=c();return m(a.updateOrderStatus(o))}),g(6,J,2,2,"option",28),i()()(),r(7,"div",31)(8,"div",32)(9,"div",33)(10,"span",15),n(11,"Pickup:"),i(),r(12,"span",16),n(13),b(14,"date"),i()(),r(15,"div",34)(16,"div")(17,"div"),n(18),i(),r(19,"div"),n(20),i()(),r(21,"div")(22,"button",35),x("click",function(){let o=p(e).$implicit,a=c();return m(a.copyOriginAddress(o))}),n(23," \u{1F4CB} "),i()()()(),r(24,"div")(25,"div",33)(26,"span",15),n(27,"Dropoff:"),i(),r(28,"span",16),n(29),b(30,"date"),i()(),r(31,"div",34)(32,"div")(33,"div"),n(34),i(),r(35,"div"),n(36),i()(),r(37,"button",35),x("click",function(){let o=p(e).$implicit,a=c();return m(a.copyDestinationAddress(o))}),n(38," \u{1F4CB} "),i()()(),r(39,"div",36)(40,"div",37)(41,"span",16),n(42,"Order #:"),i(),r(43,"span",16),n(44),i()(),r(45,"button",24),x("click",function(){let o=p(e).$implicit,a=c();return m(a.viewOrder(o))}),n(46," View Details "),i()()()()}if(l&2){let e=t.$implicit,s=c();d(3),u(e.loadNumber),d(2),h("ngModel",e.status),d(),_("ngForOf",s.statuses),d(7),E(" ",S(14,14,e.pickupDateAndTime,"EEE, MMM dd HH:mm"),""),d(5),u(e.originStreetAddress),d(2),C("",e.originCity,", ",e.originState," ",e.originZipcode,""),d(9),E(" ",S(30,17,e.dropOffDateAndTime,"EEE, MMM dd HH:mm"),""),d(5),u(e.destinationStreetAddress),d(2),C("",e.destinationCity,", ",e.destinationState," ",e.destinationZipcode,""),d(8),u(e.orderNumber)}}var G=class l{constructor(t,e,s){this.router=t;this.ordersService=e;this.toastService=s}orders=[];statuses=[v.ASSIGNED,v.READY_FOR_PICKUP,v.IN_TRANSIT];currentOrders=[];upcomingOrders=[];ngOnInit(){this.loadOrders()}loadOrders(){this.ordersService.getDriverOrders().subscribe(t=>{this.orders=t,this.splitOrders()})}splitOrders(){this.currentOrders=this.orders.filter(t=>t.status===v.READY_FOR_PICKUP||t.status===v.IN_TRANSIT||t.status===v.PARTIALLY_DELIVERED),this.upcomingOrders=this.orders.filter(t=>t.status===v.ASSIGNED)}viewOrder(t){this.ordersService.setCurrentOrder(t),this.router.navigate(["/driver/order-detail",t.id])}uploadPoD(t){this.ordersService.setCurrentOrder(t),this.router.navigate(["/driver/upload-pod",t.id])}completeOrder(t){this.ordersService.setCurrentOrder(t),this.router.navigate(["/driver/complete-order",t.id])}copyOriginAddress(t){let e=`${t.originStreetAddress}, ${t.originCity}, ${t.originState} ${t.originZipcode}`;navigator.clipboard.writeText(e),this.toastService.showSuccess("Origin address copied to clipboard",2e3)}copyDestinationAddress(t){let e=`${t.destinationStreetAddress}, ${t.destinationCity}, ${t.destinationState} ${t.destinationZipcode}`;navigator.clipboard.writeText(e),this.toastService.showSuccess("Destination address copied to clipboard",2e3)}checkIn(t){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let s={lat:e.coords.latitude,lon:e.coords.longitude};console.log("Geolocation:",s),this.ordersService.driverCheckIn(t.id,s).subscribe(()=>{this.toastService.showSuccess("Check-in successful.",2e3)})},e=>{console.warn("Geolocation error:",e),this.toastService.showError("Check-in failed.",5e3)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:6e4}):this.toastService.showError("Check-in failed.",5e3)}updateOrderStatus(t){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let s={lat:e.coords.latitude,lon:e.coords.longitude};console.log("Geolocation:",s),this.ordersService.updateOrderStatus(t.id,t.status,s).subscribe(()=>{this.loadOrders(),this.toastService.showSuccess("Status updated.",2e3)})},e=>{console.warn("Geolocation error:",e),this.ordersService.updateOrderStatus(t.id,t.status).subscribe(()=>{this.loadOrders(),this.toastService.showSuccess("Status updated.",2e3)})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:6e4}):this.ordersService.updateOrderStatus(t.id,t.status).subscribe(()=>{this.loadOrders(),this.toastService.showSuccess("Status updated.",2e3)})}isPartiallyDelivered(t){return t.status===v.PARTIALLY_DELIVERED}isReadyToComplete(t){return t.status===v.PARTIALLY_DELIVERED&&t.documents.some(e=>e.documentType==j.POD)}static \u0275fac=function(e){return new(e||l)(O(M),O(H),O($))};static \u0275cmp=D({type:l,selectors:[["app-driver-orders"]],decls:15,vars:4,consts:[["partiallyDelivered",""],[1,"max-w-md","mx-auto","pt-0"],[1,"text-2xl","font-bold","text-green-900","mb-4","flex","items-center","gap-2"],[1,"mb-6"],["class","text-gray-500 text-center py-4 bg-gray-50 rounded-lg",4,"ngIf"],["class","mb-3 rounded-xl shadow border border-green-200 bg-green-50 p-2 flex flex-col gap-2",4,"ngFor","ngForOf"],[1,"text-lg","font-semibold","text-blue-800","mb-3","flex","items-center","gap-2"],["class","mb-3 rounded-xl shadow border border-blue-200 bg-blue-50 p-2 flex flex-col gap-2",4,"ngFor","ngForOf"],[1,"text-gray-500","text-center","py-4","bg-gray-50","rounded-lg"],[1,"mb-3","rounded-xl","shadow","border","border-green-200","bg-green-50","p-2","flex","flex-col","gap-2"],[1,"flex","justify-between","items-center"],[1,"font-semibold","text-green-900"],["class","px-2 py-1 rounded text-s font-semibold",4,"ngIf","ngIfElse"],[1,"text-sm","text-gray-700","space-y-3"],[1,"flex","justify-between","items-center","mb-1"],[1,"font-semibold"],[1,"text-xs","text-gray-500"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-blue-600","hover:text-blue-800","p-1","ml-2",3,"click"],[1,"flex","justify-between","items-center","pt-2","border-t","border-green-200"],[1,"text-xs","font-medium"],[1,"flex","flex-row","justify-end","mt-2","gap-1"],[1,"bg-blue-600","hover:bg-blue-700","text-white","p-3","rounded","text-s","font-semibold","transition",3,"click"],[1,"bg-green-600","hover:bg-green-700","text-white","p-3","rounded","text-s","font-semibold","transition",3,"click"],["class","bg-green-600 hover:bg-green-700 text-white p-3 rounded text-s font-semibold transition",3,"click",4,"ngIf"],[1,"px-2","py-1","rounded","text-s","font-semibold"],[1,"bg-transparent","border-none","text-right","font-semibold","cursor-pointer","outline-none",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mb-3","rounded-xl","shadow","border","border-blue-200","bg-blue-50","p-2","flex","flex-col","gap-2"],[1,"text-sm","text-gray-700"],[1,"mb-2"],[1,"flex","flex-row","justify-between","gap-2"],[1,"ml-2","flex","flex-row","items-center","gap-2"],[1,"text-blue-600","hover:text-blue-800","p-1",3,"click"],[1,"flex","flex-row","items-center","justify-between","mt-2","gap-1"],[1,"flex","flex-col"]],template:function(e,s){e&1&&(r(0,"div",1)(1,"h2",2)(2,"span"),n(3,"\u{1F69B}"),i(),n(4," Current Orders "),i(),r(5,"div",3),g(6,W,2,0,"div",4)(7,q,52,21,"div",5),i(),r(8,"div")(9,"h3",6)(10,"span"),n(11,"\u{1F4C5}"),i(),n(12," Upcoming Orders "),i(),g(13,z,2,0,"div",4)(14,Q,47,20,"div",7),i()()),e&2&&(d(6),_("ngIf",s.currentOrders.length===0),d(),_("ngForOf",s.currentOrders),d(6),_("ngIf",s.upcomingOrders.length===0),d(),_("ngForOf",s.upcomingOrders))},dependencies:[V,k,A,L,F,B,R,P,N],encapsulation:2})};export{G as CurrentOrdersComponent};
