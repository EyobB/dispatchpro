import{b,d as v,e as x,f as w,g as y,h as M,q as R,u as q}from"./chunk-VDT5TDP2.js";import{a as S}from"./chunk-25LA7BX7.js";import"./chunk-ZTGCRYCC.js";import"./chunk-XPCCV2FB.js";import{e as h}from"./chunk-KM6ROI6B.js";import"./chunk-2DXK6GBI.js";import"./chunk-TKJYB7RJ.js";import{Db as g,Eb as m,Fb as u,Ka as a,Pa as d,Ua as p,jb as i,kb as t,rb as f,yb as r}from"./chunk-ITTAAY47.js";var C=class c{constructor(s,e){this.router=s;this.sessionService=e}loginRequest={email:"",password:""};login(){this.loginRequest.email&&this.loginRequest.password&&this.sessionService.login(this.loginRequest.email,this.loginRequest.password).subscribe(s=>{if(!s)console.error("Login failed");else{let e=this.sessionService.getLoggedInUser();if(!e){console.error("Failed to retrieve logged in user");return}let n=e.roles.includes("Driver"),l=e.roles.includes("Dispatcher"),o=e.roles.includes("Admin"),_=e.roles.includes("SuperAdmin");if(this.sessionService.isMobileScreen()&&n)this.router.navigate(["/driver/current-orders"]);else if(o&&!this.sessionService.isMobileScreen())this.router.navigate(["/dispatcher/users"]);else if(l&&!this.sessionService.isMobileScreen())this.router.navigate(["/dispatcher/orders"]);else if(_&&!this.sessionService.isMobileScreen())this.router.navigate(["/dispatcher/users"]);else{this.sessionService.logout();let L="This device is not suitable for your role: "+e.roles.concat(", ");this.router.navigate(["/error",L])}}},s=>{console.error("Login error:",s)})}resetForm(){this.loginRequest.email="",this.loginRequest.password=""}static \u0275fac=function(e){return new(e||c)(d(h),d(S))};static \u0275cmp=p({type:c,selectors:[["app-login"]],decls:25,vars:2,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-green-100","to-green-300","px-2"],[1,"bg-white","rounded-2xl","shadow-2xl","p-6","sm:p-8","w-full","max-w-md"],[1,"flex","flex-col","items-center","mb-6"],[1,"text-5xl","mb-2"],[1,"text-3xl","font-bold","text-green-900","mb-2","text-center"],[1,"text-green-700","text-center"],[1,"space-y-4",3,"ngSubmit"],[1,"mb-4"],["for","email",1,"block","text-green-900","font-semibold","mb-1"],["id","email","type","email","name","email","required","",1,"w-full","border","border-green-200","rounded","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-400",3,"ngModelChange","ngModel"],["for","password",1,"block","text-green-900","font-semibold","mb-1"],["id","password","type","password","name","password","required","",1,"w-full","border","border-green-200","rounded","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-400",3,"ngModelChange","ngModel"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4","gap-2"],["href","#",1,"text-green-700","hover:underline","text-sm","text-right"],["type","submit",1,"w-full","bg-green-600","hover:bg-green-700","text-white","font-bold","py-2","rounded","transition"],[1,"mt-6","text-center","text-green-800","text-sm"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),r(4,"\u{1F69A}"),t(),i(5,"h2",4),r(6,"DispatchPro Login"),t(),i(7,"p",5),r(8,"Sign in to your account"),t()(),i(9,"form",6),f("ngSubmit",function(){return n.login()}),i(10,"div",7)(11,"label",8),r(12,"Email"),t(),i(13,"input",9),u("ngModelChange",function(o){return m(n.loginRequest.email,o)||(n.loginRequest.email=o),o}),t()(),i(14,"div",7)(15,"label",10),r(16,"Password"),t(),i(17,"input",11),u("ngModelChange",function(o){return m(n.loginRequest.password,o)||(n.loginRequest.password=o),o}),t()(),i(18,"div",12)(19,"a",13),r(20,"Forgot password?"),t()(),i(21,"button",14),r(22," Sign In "),t()(),i(23,"div",15),r(24," \xA9 2025 DispatcherPro. All rights reserved. "),t()()()),e&2&&(a(13),g("ngModel",n.loginRequest.email),a(4),g("ngModel",n.loginRequest.password))},dependencies:[q,M,b,v,x,R,y,w],encapsulation:2})};export{C as LoginComponent};
