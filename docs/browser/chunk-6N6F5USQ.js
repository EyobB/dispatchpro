import{a as N}from"./chunk-2CBSTRET.js";import{a as R}from"./chunk-C72DZDNH.js";import{b as M,d as w,g as k,l as O,m as L,n as F,u as T}from"./chunk-VDT5TDP2.js";import"./chunk-25LA7BX7.js";import"./chunk-ZTGCRYCC.js";import"./chunk-XPCCV2FB.js";import"./chunk-KM6ROI6B.js";import"./chunk-2DXK6GBI.js";import{l as _,p as E}from"./chunk-TKJYB7RJ.js";import{Db as g,Eb as u,Fb as f,Ka as o,Nb as S,Pa as b,Pb as x,Ua as D,Za as y,fb as c,jb as e,kb as t,lb as C,rb as h,yb as r,zb as d}from"./chunk-ITTAAY47.js";function Z(p,n){if(p&1&&(e(0,"option",25),r(1),t()),p&2){let i=n.$implicit;c("value",i),o(),d(i)}}function j(p,n){if(p&1&&(e(0,"option",25),r(1),t()),p&2){let i=n.$implicit;c("value",i),o(),d(i)}}function B(p,n){if(p&1&&(e(0,"tr",26)(1,"td",27),r(2),t(),e(3,"td",27),r(4),t(),e(5,"td",27),r(6),t(),e(7,"td",27),r(8),S(9,"date"),t(),e(10,"td",27),r(11),t(),e(12,"td",27),r(13),t(),e(14,"td",27),r(15),t(),e(16,"td",27),r(17),S(18,"date"),t(),e(19,"td",27),r(20),t(),e(21,"td",27),r(22),t()()),p&2){let i=n.$implicit;o(2),d(i.originCity),o(2),d(i.originState),o(2),d(i.originZipcode),o(2),d(x(9,10,i.pickupDateAndTime,"MM/dd/yy")),o(3),d(i.destinationCity),o(2),d(i.destinationState),o(2),d(i.destinationZipcode),o(2),d(x(18,13,i.dropOffDateAndTime,"MM/dd/yy")),o(3),d(i.driverName),o(2),d(i.truckNumber)}}var I=class p{constructor(n){this.orderService=n}orders=[];filters={startDate:this.toYMD(new Date(new Date().setMonth(new Date().getMonth()-1))),endDate:this.toYMD(new Date),driver:"",truck:"",status:""};ngOnInit(){this.applyFilters()}drivers=[];trucks=[];applyFilters(){this.orderService.getOrdersReport(this.filters.startDate,this.filters.endDate).subscribe(n=>{this.drivers=Array.from(new Set(n.map(i=>i.driverName))).sort(),this.trucks=Array.from(new Set(n.map(i=>i.truckNumber))).sort(),this.orders=n})}get filteredOrders(){return this.orders.filter(n=>{let i=!this.filters.driver||n.driverName===this.filters.driver,a=!this.filters.truck||n.truckNumber===this.filters.truck,m=!this.filters.status||n.status===this.filters.status;return i&&a&&m})}toYMD(n){let i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),m=String(n.getDate()).padStart(2,"0");return`${i}-${a}-${m}`}exportToCsv(){let n=["Origin City","Origin State","Origin Zip","Pickup Date","Destination City","Destination State","Destination Zip","Delivery Date","Driver","Truck"],i=[];i.push(n.map(s=>this.toCsvValue(s)).join(",")),this.filteredOrders.forEach(s=>{let A=[s.originCity??"",s.originState??"",s.originZipcode??"",this.formatDateForCsv(s.pickupDateAndTime),s.destinationCity??"",s.destinationState??"",s.destinationZipcode??"",this.formatDateForCsv(s.dropOffDateAndTime),s.driverName??"",s.truckNumber??""];i.push(A.map(P=>this.toCsvValue(P)).join(","))});let a="\uFEFF"+i.join(`\r
`),m=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(m),v=document.createElement("a"),W=`orders_${this.filters.startDate||"all"}_to_${this.filters.endDate||"all"}.csv`;v.href=l,v.download=W,v.click(),URL.revokeObjectURL(l)}formatDateForCsv(n){if(!n)return"";let i=new Date(n);return isNaN(i.getTime())?"":i.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})}toCsvValue(n){let a=String(n??"").replace(/"/g,'""');return/[",\r\n]/.test(a)?`"${a}"`:a}static \u0275fac=function(i){return new(i||p)(b(R))};static \u0275cmp=D({type:p,selectors:[["app-list-report"]],decls:67,vars:7,consts:[[1,"order-list-report","p-6","bg-gray-100","w-full"],[1,"text-2xl","font-bold","text-gray-800","mb-4"],[1,"mb-4","flex","gap-4","justify-end","w-full","items-center"],[1,"flex-auto"],[1,"bg-blue-500","text-white","px-4","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"filters","mb-6","flex","flex-wrap","gap-4"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-gray-600"],["type","date","id","startDate",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["for","endDate",1,"text-gray-600"],["type","date","id","endDate",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["for","driver",1,"text-gray-600"],["id","driver",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","truck",1,"text-gray-600"],["id","truck",1,"border","border-gray-300","rounded","px-2","py-1",3,"ngModelChange","ngModel"],[1,"bg-green-500","text-white","px-4","py-2","rounded","hover:bg-green-600",3,"click"],[1,"overflow-x-auto","max-w-screen-xl"],[1,"table-auto","border-collapse","border","border-gray-300","bg-white","shadow-md","rounded-lg","w-full"],[1,"bg-gray-200"],["colspan","4",1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],["colspan","2",1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],[1,"border","border-gray-300","px-4","py-2","text-left","text-gray-600"],["class","hover:bg-gray-100",4,"ngFor","ngForOf"],[3,"value"],[1,"hover:bg-gray-100"],[1,"border","border-gray-300","px-4","py-2"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"h2",1),r(2,"Order List Report"),t(),e(3,"div",2),C(4,"app-order-menu")(5,"span",3),e(6,"button",4),h("click",function(){return a.exportToCsv()}),r(7," Export to CSV "),t()(),e(8,"div",5)(9,"div",6)(10,"label",7),r(11,"Start Date:"),t(),e(12,"input",8),f("ngModelChange",function(l){return u(a.filters.startDate,l)||(a.filters.startDate=l),l}),t()(),e(13,"div",6)(14,"label",9),r(15,"End Date:"),t(),e(16,"input",10),f("ngModelChange",function(l){return u(a.filters.endDate,l)||(a.filters.endDate=l),l}),t()(),e(17,"div",6)(18,"label",11),r(19,"Driver:"),t(),e(20,"select",12),f("ngModelChange",function(l){return u(a.filters.driver,l)||(a.filters.driver=l),l}),e(21,"option",13),r(22,"All"),t(),y(23,Z,2,2,"option",14),t()(),e(24,"div",6)(25,"label",15),r(26,"Truck:"),t(),e(27,"select",16),f("ngModelChange",function(l){return u(a.filters.truck,l)||(a.filters.truck=l),l}),e(28,"option",13),r(29,"All"),t(),y(30,j,2,2,"option",14),t()(),e(31,"button",17),h("click",function(){return a.applyFilters()}),r(32," Apply Filters "),t()(),e(33,"div",18)(34,"table",19)(35,"thead",20)(36,"tr")(37,"th",21),r(38,"Origin"),t(),e(39,"th",21),r(40,"Destination"),t(),e(41,"th",22),r(42,"Logistics"),t()()(),e(43,"thead",20)(44,"tr")(45,"th",23),r(46,"City"),t(),e(47,"th",23),r(48,"State"),t(),e(49,"th",23),r(50,"Zip"),t(),e(51,"th",23),r(52,"Pickup Date"),t(),e(53,"th",23),r(54,"City"),t(),e(55,"th",23),r(56,"State"),t(),e(57,"th",23),r(58,"Zip"),t(),e(59,"th",23),r(60,"Delivery Date"),t(),e(61,"th",23),r(62,"Driver"),t(),e(63,"th",23),r(64,"Truck"),t()()(),e(65,"tbody"),y(66,B,23,16,"tr",24),t()()()()),i&2&&(o(12),g("ngModel",a.filters.startDate),o(4),g("ngModel",a.filters.endDate),o(4),g("ngModel",a.filters.driver),o(3),c("ngForOf",a.drivers),o(4),g("ngModel",a.filters.truck),o(3),c("ngForOf",a.trucks),o(36),c("ngForOf",a.filteredOrders))},dependencies:[T,L,F,M,O,w,k,E,_,N],encapsulation:2})};export{I as ListReportComponent};
