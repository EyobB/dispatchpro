import{a as B}from"./chunk-A22K7ZIL.js";import{a as A,c as L,f as z,i as R,j as W,k as j,o as P}from"./chunk-WIAEWHLW.js";import{d as V,f as D}from"./chunk-3KQDNKNL.js";import{k as F,l as N,m as T}from"./chunk-B35W4A7H.js";import{Ab as w,Fb as k,Ga as s,La as f,Qa as M,Va as u,ab as c,db as n,ea as x,eb as t,fa as h,fb as I,ga as O,ha as E,ib as v,lb as g,mb as p,tb as r,ub as m,vb as S,xb as _,yb as b,zb as C}from"./chunk-WMTXBNFA.js";var $=(a,i,e)=>({"bg-green-100 text-green-800":a,"bg-yellow-100 text-yellow-800":i,"bg-red-100 text-red-800":e});function q(a,i){if(a&1){let e=v();n(0,"label",22)(1,"input",27),w("ngModelChange",function(l){let d=x(e).$implicit,y=p(2);return C(y.selectedStatusesMap[d],l)||(y.selectedStatusesMap[d]=l),h(l)}),g("change",function(){x(e);let l=p(2);return h(l.onStatusFilterChange())}),t(),r(2),t()}if(a&2){let e=i.$implicit,o=p(2);s(),b("ngModel",o.selectedStatusesMap[e]),s(),S(" ",e," ")}}function G(a,i){if(a&1){let e=v();n(0,"div",20)(1,"div",21)(2,"label",22)(3,"input",23),g("change",function(l){x(e);let d=p();return h(d.toggleSelectAllStatuses(l))}),t(),n(4,"span",24),r(5,"Select/Deselect All"),t()()(),n(6,"div",25),u(7,q,3,2,"label",26),t()()}if(a&2){let e=p();s(3),c("checked",e.allStatusesSelected()),s(4),c("ngForOf",e.orderStatuses)}}function J(a,i){if(a&1){let e=v();n(0,"div",28),g("click",function(){x(e);let l=p();return h(l.showStatusDropdown=!1)}),t()}}function K(a,i){if(a&1&&(n(0,"option",29),r(1),t()),a&2){let e=i.$implicit;c("value",e),s(),m(e)}}function Q(a,i){if(a&1&&(n(0,"div",34),r(1),t()),a&2){let e=p().$implicit;s(),m(e.driver.phone)}}function U(a,i){if(a&1){let e=v();n(0,"tr",30)(1,"td",31)(2,"div"),r(3),t(),n(4,"span",32),r(5),t()(),n(6,"td",33)(7,"div",24),r(8),t(),n(9,"div",34),r(10),t()(),n(11,"td",33)(12,"div",24),r(13),t()(),n(14,"td",33)(15,"div"),r(16),t(),n(17,"div",34),r(18),t()(),n(19,"td",33)(20,"div"),r(21),t(),n(22,"div",34),r(23),t()(),n(24,"td",33)(25,"div"),r(26),t(),u(27,Q,2,1,"div",35),t(),n(28,"td",33)(29,"button",36),g("click",function(){let l=x(e).$implicit,d=p();return h(d.viewOrder(l.id))}),r(30," View "),t()()()}if(a&2){let e=i.$implicit;s(3),m(e.orderNumber),s(),c("ngClass",k(16,$,e.status==="Delivered",e.status==="In Transit",e.status==="Cancelled")),s(),S(" ",e.status," "),s(3),m(e.customerName),s(2),m(e.customerContact),s(3),m(e.loadNumber),s(3),m(e.origin.street),s(2),_("",e.origin.city,", ",e.origin.state," ",e.origin.zip,""),s(3),m(e.destination.street),s(2),_("",e.destination.city,", ",e.destination.state," ",e.destination.zip,""),s(3),m((e.driver==null?null:e.driver.name)||"\u2014"),s(),c("ngIf",e.driver)}}var H=class a{constructor(i,e,o){this.router=i;this.route=e;this.ordersService=o}orderStatuses=["New","In Transit","Delivered","Cancelled"];selectedStatusesMap={};orders=[];filteredOrders=[];showStatusDropdown=!1;customerNames=[];selectedCustomer="";ngOnInit(){this.loadOrders(),this.applyStatusFilters(),this.onStatusFilterChange()}loadOrders(){this.ordersService.getOrders().subscribe(i=>{this.orders=i,this.customerNames=Array.from(new Set(i.map(e=>e.customerName))).sort(),this.filteredOrders=i},i=>{console.error("Error loading orders:",i)})}applyStatusFilters(){let i=this.route.snapshot.queryParamMap.get("status")||"";i?(this.orderStatuses.forEach(e=>{this.selectedStatusesMap[e]=!1}),this.selectedStatusesMap[i]=!0):(this.orderStatuses.forEach(e=>{this.selectedStatusesMap[e]=!0}),this.selectedStatusesMap.Cancelled=!1)}onStatusFilterChange(){this.applyFilters()}onCustomerFilterChange(){this.applyFilters()}applyFilters(){let i=this.orderStatuses.filter(e=>this.selectedStatusesMap[e]);this.filteredOrders=this.orders.filter(e=>{let o=i.includes(e.status),l=!this.selectedCustomer||e.customerName===this.selectedCustomer;return o&&l})}viewOrder(i){this.router.navigate(["/dispatcher/orders/",i])}getSelectedStatusesLabel(){let i=this.orderStatuses.filter(e=>this.selectedStatusesMap[e]);return i.length===0?"None selected":i.length===this.orderStatuses.length?"All selected":i.join(", ")}allStatusesSelected(){return this.orderStatuses.every(i=>this.selectedStatusesMap[i])}toggleSelectAllStatuses(i){let e=i.target.checked;this.orderStatuses.forEach(o=>this.selectedStatusesMap[o]=e),this.onStatusFilterChange()}static \u0275fac=function(e){return new(e||a)(f(D),f(V),f(B))};static \u0275cmp=M({type:a,selectors:[["app-orders"]],decls:43,vars:6,consts:[[1,"p-6","pt-0"],[1,"text-3xl","font-bold","mb-6","text-green-900","flex","items-center","gap-2"],[1,"mb-4","flex","items-center","gap-4","relative"],[1,"flex","items-center","gap-2","relative"],[1,"font-semibold","text-green-900","mr-2"],[1,"relative"],["type","button",1,"bg-green-50","border","border-green-200","rounded","px-4","py-2","text-sm","flex","items-center","gap-2",3,"click"],["fill","none","stroke","currentColor","stroke-width","2","viewBox","0 0 24 24",1,"w-4","h-4","ml-1"],["stroke-linecap","round","stroke-linejoin","round","d","M19 9l-7 7-7-7"],["class","absolute left-0 mt-2 w-56 bg-white border border-green-200 rounded shadow-lg z-10",4,"ngIf"],["class","fixed inset-0 z-0","style","background: transparent",3,"click",4,"ngIf"],[1,"bg-green-50","border","border-green-200","rounded","px-4","py-2","text-sm",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"overflow-x-auto","rounded-lg","shadow-lg","bg-white"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-green-900","text-white"],[1,"px-4","py-3","text-left","font-semibold"],[1,"bg-white","divide-y","divide-gray-100"],["class","hover:bg-green-50 transition",4,"ngFor","ngForOf"],[1,"absolute","left-0","mt-2","w-56","bg-white","border","border-green-200","rounded","shadow-lg","z-10"],[1,"px-3","py-2","border-b","border-green-100","flex","flex-col","gap-1"],[1,"flex","items-center","gap-2","cursor-pointer"],["type","checkbox",1,"accent-green-600",3,"change","checked"],[1,"font-semibold"],[1,"max-h-48","overflow-y-auto","px-3","py-2","flex","flex-col","gap-1"],["class","flex items-center gap-2 cursor-pointer",4,"ngFor","ngForOf"],["type","checkbox",1,"accent-green-600",3,"ngModelChange","change","ngModel"],[1,"fixed","inset-0","z-0",2,"background","transparent",3,"click"],[3,"value"],[1,"hover:bg-green-50","transition"],[1,"px-4","py-1","font-medium","text-green-900"],[1,"mt-1","inline-block","px-2","py-1","rounded","text-xs","font-semibold",3,"ngClass"],[1,"px-4","py-1"],[1,"text-xs","text-gray-500"],["class","text-xs text-gray-500",4,"ngIf"],[1,"bg-blue-600","hover:bg-blue-700","transition","text-white","px-3","py-1","rounded","shadow",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1)(2,"span"),r(3,"\u{1F4E6}"),t(),r(4," Orders "),t(),n(5,"div",2)(6,"div",3)(7,"label",4),r(8,"Status:"),t(),n(9,"div",5)(10,"button",6),g("click",function(){return o.showStatusDropdown=!o.showStatusDropdown}),r(11),O(),n(12,"svg",7),I(13,"path",8),t()(),u(14,G,8,2,"div",9),t(),u(15,J,1,0,"div",10),t(),E(),n(16,"div",3)(17,"label",4),r(18,"Customer:"),t(),n(19,"select",11),w("ngModelChange",function(d){return C(o.selectedCustomer,d)||(o.selectedCustomer=d),d}),g("change",function(){return o.onCustomerFilterChange()}),n(20,"option",12),r(21,"All"),t(),u(22,K,2,2,"option",13),t()()(),n(23,"div",14)(24,"table",15)(25,"thead",16)(26,"tr")(27,"th",17),r(28,"Order #"),t(),n(29,"th",17),r(30,"Customer"),t(),n(31,"th",17),r(32,"Load #"),t(),n(33,"th",17),r(34,"Origin"),t(),n(35,"th",17),r(36,"Destination"),t(),n(37,"th",17),r(38,"Driver"),t(),n(39,"th",17),r(40,"Actions"),t()()(),n(41,"tbody",18),u(42,U,31,20,"tr",19),t()()()()),e&2&&(s(11),S(" ",o.getSelectedStatusesLabel()," "),s(3),c("ngIf",o.showStatusDropdown),s(),c("ngIf",o.showStatusDropdown),s(4),b("ngModel",o.selectedCustomer),s(3),c("ngForOf",o.customerNames),s(20),c("ngForOf",o.filteredOrders))},dependencies:[N,T,F,P,W,j,A,R,L,z],encapsulation:2})};export{H as OrdersComponent};
