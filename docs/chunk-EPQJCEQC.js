import{a as M,b as N}from"./chunk-UIIJYSZH.js";import{a as A}from"./chunk-3QMJAE3L.js";import{a as E,c as p}from"./chunk-7GTRUKFK.js";import{a as j}from"./chunk-7FUB44TE.js";import{u as P}from"./chunk-2PVWNWUN.js";import"./chunk-LIL63FBP.js";import{a as k}from"./chunk-OXCJF6DH.js";import"./chunk-NBSK5KUW.js";import"./chunk-IMHYAPIP.js";import"./chunk-XPCCV2FB.js";import{c as T,e as V,f as R}from"./chunk-3TOGTSGL.js";import"./chunk-FSJQQIFH.js";import{l as O,m as C,p as I}from"./chunk-QAAQ2EEP.js";import{$ as _,Ab as s,Cb as y,Db as w,La as d,Nb as b,Pb as h,Qa as v,Va as S,_ as x,_a as g,gb as m,kb as r,lb as e,pb as D,sb as f,tb as c,zb as i}from"./chunk-QJGZKU5F.js";function L(a,o){if(a&1){let n=D();r(0,"li",20)(1,"a",21),f("click",function(){let l=x(n).$implicit,u=c(2);return _(u.viewDocument(l))}),i(2),e(),r(3,"button",22),f("click",function(){let l=x(n).$implicit,u=c(2);return _(u.viewDocument(l))}),i(4,"View"),e()()}if(a&2){let n=o.$implicit;d(2),y(" ",n.fileName," (",n.documentType,")")}}function H(a,o){if(a&1&&(r(0,"div",18)(1,"div",11)(2,"span",7),i(3,"Documents:"),e()(),g(4,L,5,2,"li",19),e()),a&2){let n=c();d(4),m("ngForOf",n.getDocs())}}function B(a,o){if(a&1){let n=D();r(0,"button",23),f("click",function(){x(n);let l=c();return _(l.completeOrder())}),i(1," Complete Order "),e()}if(a&2){let n=c();m("disabled",n.order.status==="Delivered")}}var F=class a{constructor(o,n,t,l){this.orderService=o;this.route=n;this.router=t;this.toastService=l}order=new N;otherReason="";otherRemark="";podImage=null;currentDocument=new E;showDocumentViewer=!1;ngOnInit(){let o=this.route.snapshot.paramMap.get("id");o&&this.orderService.getOrder(o).subscribe(n=>{if(!n){console.error("Order not found");return}this.order=n})}isPartiallyDelivered(){return this.order.status===M.PARTIALLY_DELIVERED}getDocs(){return this.order.documents.filter(o=>o.documentType===p.POD||o.documentType===p.RATE_CON)}hasDocs(){return this.order.documents&&this.order.documents.length>0&&this.order.documents.some(o=>o.documentType===p.POD||o.documentType===p.RATE_CON)}hasPoDs(){return this.order.documents&&this.order.documents.length>0&&this.order.documents.some(o=>o.documentType===p.POD)}viewDocument(o){this.currentDocument=o,this.showDocumentViewer=!0}closeDocumentViewer(){this.showDocumentViewer=!1,this.currentDocument=new E}onDownloadError(o){console.error("Download failed:",o),this.toastService.showError("Failed to download document")}onPodSelected(o){let n=o.target;if(n.files&&n.files[0]){let t=new FileReader;t.onload=l=>{this.podImage=l.target.result},t.readAsDataURL(n.files[0])}}removePod(){this.podImage=null}completeOrder(){this.router.navigate(["/driver/complete-order",this.order.id])}static \u0275fac=function(n){return new(n||a)(v(j),v(T),v(V),v(k))};static \u0275cmp=S({type:a,selectors:[["app-order-detail"]],decls:61,vars:25,consts:[[1,"max-w-md","w-full","mx-auto","min-h-screen"],[1,"mb-4","flex","flex-row","justify-between","items-center"],[1,"text-2xl","font-bold","text-green-900","flex","items-center","gap-2"],["routerLink","/driver/current-orders",1,"text-green-800","cursor-pointer","hover:underline","flex","items-center","gap-1","font-medium"],[1,"text-xl"],[1,"rounded-xl","shadow","border","border-green-100","bg-green-50","p-4","mb-4"],[1,"flex","justify-between","items-start","mb-3"],[1,"font-semibold","text-gray-700"],[1,"text-right","font-medium"],[1,"text-right"],[1,"text-xs","text-gray-500","mt-1"],[1,"flex","justify-between","items-center","mb-3"],[1,"px-2","py-1","bg-blue-600","text-white","rounded","text-sm","font-medium"],[1,"text-right","max-w-48"],[1,"flex","justify-between","items-start"],["class","mb-4",4,"ngIf"],[3,"close","downloadError","document","isVisible"],["class","w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow font-semibold transition mt-4",3,"disabled","click",4,"ngIf"],[1,"mb-4"],["class","flex justify-between bg-gray-100 p-2 mb-1 rounded",4,"ngFor","ngForOf"],[1,"flex","justify-between","bg-gray-100","p-2","mb-1","rounded"],["href","javascript:void(0)",1,"text-blue-500","underline","cursor-pointer",3,"click"],[1,"text-blue-600","hover:underline",3,"click"],[1,"w-full","bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded","shadow","font-semibold","transition","mt-4",3,"click","disabled"]],template:function(n,t){n&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2)(3,"span"),i(4,"\u{1F4E6}"),e(),i(5," Order Details "),e(),r(6,"a",3)(7,"span",4),i(8,"\u2190"),e(),i(9," Go Back "),e()(),r(10,"div",5)(11,"div",6)(12,"span",7),i(13,"Load #:"),e(),r(14,"span",8),i(15),e()(),r(16,"div",6)(17,"span",7),i(18,"Pickup:"),e(),r(19,"div",9)(20,"div"),i(21),e(),r(22,"div"),i(23),e(),r(24,"div",10),i(25),b(26,"date"),e()()(),r(27,"div",6)(28,"span",7),i(29,"Dropoff:"),e(),r(30,"div",9)(31,"div"),i(32),e(),r(33,"div"),i(34),e(),r(35,"div",10),i(36),b(37,"date"),e()()(),r(38,"div",11)(39,"span",7),i(40,"Status:"),e(),r(41,"span",12),i(42),e()(),r(43,"div",11)(44,"span",7),i(45,"Order #:"),e(),r(46,"span",8),i(47),e()(),r(48,"div",6)(49,"span",7),i(50,"Description:"),e(),r(51,"span",13),i(52),e()(),r(53,"div",14)(54,"span",7),i(55,"Requirements:"),e(),r(56,"span",13),i(57),e()()(),g(58,H,5,1,"div",15),r(59,"app-document-viewer",16),f("close",function(){return t.closeDocumentViewer()})("downloadError",function(u){return t.onDownloadError(u)}),e(),g(60,B,2,1,"button",17),e()),n&2&&(d(15),s(t.order.loadNumber),d(6),s(t.order.originStreetAddress),d(2),w("",t.order.originCity,", ",t.order.originState," ",t.order.originZipcode,""),d(2),s(h(26,19,t.order.pickupDateAndTime,"EEE, MMM dd HH:mm")),d(7),s(t.order.destinationStreetAddress),d(2),w("",t.order.destinationCity,", ",t.order.destinationState," ",t.order.destinationZipcode,""),d(2),s(h(37,22,t.order.dropOffDateAndTime,"EEE, MMM dd HH:mm")),d(6),s(t.order.status),d(5),s(t.order.orderNumber),d(5),s(t.order.loadDescription),d(5),s(t.order.deliveryRequirements),d(),m("ngIf",t.hasDocs()),d(),m("document",t.currentDocument)("isVisible",t.showDocumentViewer),d(),m("ngIf",t.isPartiallyDelivered()&&t.hasPoDs()))},dependencies:[C,O,P,I,R,A],encapsulation:2})};export{F as OrderDetailComponent};
